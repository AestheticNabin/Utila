 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Professional Color Picker & Converter</title>
  <style>
    /* --- Original Theme Colors --- */
    :root {
      --bg-color: #f2f9ff;
      --primary-blue: #007bff;
      --primary-hover: #0056b3;
      --white: #ffffff;
      --light-blue-bg: #e9f7ff;
      --shadow: rgba(0,0,0,0.05);
      --text-color: #333;
    }

    body {
      font-family: Arial, sans-serif;
      background: var(--bg-color);
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      color: var(--text-color);
      margin: 0;
    }

    h2 {
      color: var(--primary-blue);
      margin-bottom: 20px;
      text-align: center;
    }

    /* --- Main Container --- */
    .picker-box {
      background: var(--white);
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 15px var(--shadow);
      max-width: 500px;
      width: 100%;
      box-sizing: border-box;
    }

    /* --- Top Section: Preview & Picker --- */
    .top-section {
      display: flex;
      gap: 15px;
      align-items: center;
      margin-bottom: 20px;
    }

    .color-preview-large {
      flex: 1;
      height: 60px;
      border-radius: 8px;
      border: 1px solid #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: #fff; /* Dynamic text color handled by JS */
      text-transform: uppercase;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
      transition: background-color 0.2s;
    }

    /* Customizing the native color input */
    .color-input-wrapper {
      position: relative;
      width: 60px;
      height: 60px;
      overflow: hidden;
      border-radius: 8px;
      cursor: pointer;
    }

    input[type="color"] {
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      cursor: pointer;
      border: none;
      padding: 0;
      margin: 0;
    }

    /* --- Data Rows (Inputs) --- */
    .value-row {
      display: flex;
      align-items: center;
      background: var(--light-blue-bg);
      margin-bottom: 12px;
      padding: 8px 12px;
      border-radius: 8px;
      gap: 10px;
    }

    .label {
      font-weight: bold;
      color: var(--primary-blue);
      width: 50px;
      font-size: 14px;
    }

    .value-input {
      flex: 1;
      background: transparent;
      border: none;
      font-size: 16px;
      color: #333;
      font-family: monospace;
      outline: none;
      width: 100%;
    }

    /* Specific inputs for RGB/HSL to keep them tidy */
    .multi-input-group {
      flex: 1;
      display: flex;
      gap: 5px;
    }
    .multi-input-group input {
      width: 100%;
      background: transparent;
      border: none;
      border-bottom: 1px solid transparent;
      text-align: center;
      font-family: monospace;
      font-size: 16px;
    }
    .multi-input-group input:focus {
      border-bottom: 1px solid var(--primary-blue);
      outline: none;
    }

    /* Buttons */
    .action-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--primary-blue);
      font-size: 18px;
      padding: 4px;
      border-radius: 4px;
      transition: background 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .action-btn:hover {
      background: rgba(0, 123, 255, 0.1);
    }

    .btn-block {
      width: 100%;
      padding: 12px;
      background-color: var(--primary-blue);
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 15px;
      cursor: pointer;
      margin-top: 10px;
      font-weight: bold;
      transition: background-color 0.2s;
    }

    .btn-block:hover {
      background-color: var(--primary-hover);
    }

    /* --- History Section --- */
    .history-container {
      margin-top: 20px;
      text-align: left;
    }
    .history-title {
      font-size: 12px;
      color: #666;
      margin-bottom: 5px;
    }
    .history-list {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .history-swatch {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid #fff;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: transform 0.1s;
    }
    .history-swatch:hover {
      transform: scale(1.1);
      border-color: var(--primary-blue);
    }

    /* --- Toast Notification --- */
    #toast {
      visibility: hidden;
      min-width: 200px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 4px;
      padding: 10px;
      position: fixed;
      z-index: 1;
      bottom: 30px;
      font-size: 14px;
      opacity: 0;
      transition: opacity 0.3s, bottom 0.3s;
    }
    #toast.show {
      visibility: visible;
      opacity: 1;
      bottom: 50px;
    }

    /* Utilities */
    .hidden-copy-area {
      position: absolute;
      left: -9999px;
    }
  </style>
</head>
<body>

  <h2>Color Picker & Converter</h2>

  <div class="picker-box">
    
    <!-- Top: Preview & Picker -->
    <div class="top-section">
      <div class="color-input-wrapper" title="Click to pick a color">
        <input type="color" id="nativePicker" value="#007bff">
      </div>
      <div id="mainPreview" class="color-preview-large">
        #007BFF
      </div>
    </div>

    <!-- HEX -->
    <div class="value-row">
      <span class="label">HEX</span>
      <input type="text" id="hexInput" class="value-input" value="#007BFF" maxlength="7">
      <button class="action-btn" onclick="copyToClipboard('hexInput')" title="Copy HEX">
        &#128203; <!-- Clipboard Icon -->
      </button>
    </div>

    <!-- RGB -->
    <div class="value-row">
      <span class="label">RGB</span>
      <div class="multi-input-group">
        <input type="number" id="rgbR" min="0" max="255" placeholder="R">
        <input type="number" id="rgbG" min="0" max="255" placeholder="G">
        <input type="number" id="rgbB" min="0" max="255" placeholder="B">
      </div>
      <button class="action-btn" onclick="copyToClipboardRGB()" title="Copy RGB">
        &#128203;
      </button>
    </div>

    <!-- HSL -->
    <div class="value-row">
      <span class="label">HSL</span>
      <div class="multi-input-group">
        <input type="number" id="hslH" min="0" max="360" placeholder="H">
        <input type="number" id="hslS" min="0" max="100" placeholder="S%">
        <input type="number" id="hslL" min="0" max="100" placeholder="L%">
      </div>
      <button class="action-btn" onclick="copyToClipboardHSL()" title="Copy HSL">
        &#128203;
      </button>
    </div>

    <!-- CMYK -->
    <div class="value-row">
      <span class="label">CMYK</span>
      <div class="multi-input-group">
        <input type="number" id="cmykC" readonly placeholder="C">
        <input type="number" id="cmykM" readonly placeholder="M">
        <input type="number" id="cmykY" readonly placeholder="Y">
        <input type="number" id="cmykK" readonly placeholder="K">
      </div>
       <button class="action-btn" onclick="copyToClipboardCMYK()" title="Copy CMYK">
        &#128203;
      </button>
    </div>

    <button class="btn-block" onclick="generateRandomColor()">&#127922; Random Color</button>

    <!-- History -->
    <div class="history-container">
      <div class="history-title">Recent Colors</div>
      <div class="history-list" id="historyList">
        <!-- History items will appear here -->
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast">Copied to clipboard!</div>
  
  <!-- Hidden textarea for copying -->
  <textarea id="hiddenCopy" class="hidden-copy-area"></textarea>

  <script>
    // --- State & Elements ---
    let currentColor = { r: 0, g: 123, b: 255 }; // Default Blue
    const historyStack = [];

    // Elements
    const nativePicker = document.getElementById('nativePicker');
    const mainPreview = document.getElementById('mainPreview');
    
    const hexInput = document.getElementById('hexInput');
    
    const rgbInputs = {
      r: document.getElementById('rgbR'),
      g: document.getElementById('rgbG'),
      b: document.getElementById('rgbB')
    };

    const hslInputs = {
      h: document.getElementById('hslH'),
      s: document.getElementById('hslS'),
      l: document.getElementById('hslL')
    };

    const cmykInputs = {
      c: document.getElementById('cmykC'),
      m: document.getElementById('cmykM'),
      y: document.getElementById('cmykY'),
      k: document.getElementById('cmykK')
    };

    const historyList = document.getElementById('historyList');

    // --- Initialization ---
    window.onload = () => {
      updateUIFromRGB(0, 123, 255);
      addToHistory('#007bff');
    };

    // --- Event Listeners ---

    // 1. Native Picker Change
    nativePicker.addEventListener('input', (e) => {
      const hex = e.target.value;
      const rgb = hexToRgb(hex);
      updateUIFromRGB(rgb.r, rgb.g, rgb.b, false); // Don't update picker self loop
    });

    nativePicker.addEventListener('change', (e) => {
        // Add to history only on final selection
        addToHistory(e.target.value);
    });

    // 2. Hex Input Change
    hexInput.addEventListener('input', (e) => {
      let hex = e.target.value;
      if (!hex.startsWith('#')) { hex = '#' + hex; }
      
      if (/^#[0-9A-F]{6}$/i.test(hex)) {
        const rgb = hexToRgb(hex);
        updateUIFromRGB(rgb.r, rgb.g, rgb.b);
      }
    });

    // 3. RGB Inputs Change
    [rgbInputs.r, rgbInputs.g, rgbInputs.b].forEach(input => {
      input.addEventListener('input', () => {
        const r = parseInt(rgbInputs.r.value) || 0;
        const g = parseInt(rgbInputs.g.value) || 0;
        const b = parseInt(rgbInputs.b.value) || 0;
        updateUIFromRGB(r, g, b);
      });
    });

    // 4. HSL Inputs Change
    [hslInputs.h, hslInputs.s, hslInputs.l].forEach(input => {
      input.addEventListener('input', () => {
        const h = parseInt(hslInputs.h.value) || 0;
        const s = parseInt(hslInputs.s.value) || 0;
        const l = parseInt(hslInputs.l.value) || 0;
        const rgb = hslToRgb(h, s, l);
        updateUIFromRGB(rgb.r, rgb.g, rgb.b);
      });
    });

    // --- Core Update Logic ---

    function updateUIFromRGB(r, g, b, updatePicker = true) {
      // Clamp values
      r = Math.min(255, Math.max(0, r));
      g = Math.min(255, Math.max(0, g));
      b = Math.min(255, Math.max(0, b));

      currentColor = { r, g, b };

      // 1. Hex
      const hex = rgbToHex(r, g, b);
      hexInput.value = hex;
      mainPreview.textContent = hex;
      
      // 2. Native Picker
      if(updatePicker) {
        nativePicker.value = hex;
      }

      // 3. Preview Box
      mainPreview.style.backgroundColor = hex;
      
      // Calculate contrast color for text (black or white)
      const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
      mainPreview.style.color = luminance > 0.5 ? '#000000' : '#ffffff';

      // 4. RGB Inputs (Only update if not focused to prevent jumping cursor)
      if (document.activeElement !== rgbInputs.r) rgbInputs.r.value = r;
      if (document.activeElement !== rgbInputs.g) rgbInputs.g.value = g;
      if (document.activeElement !== rgbInputs.b) rgbInputs.b.value = b;

      // 5. HSL Inputs
      const hsl = rgbToHsl(r, g, b);
      if (document.activeElement !== hslInputs.h) hslInputs.h.value = Math.round(hsl.h);
      if (document.activeElement !== hslInputs.s) hslInputs.s.value = Math.round(hsl.s);
      if (document.activeElement !== hslInputs.l) hslInputs.l.value = Math.round(hsl.l);

      // 6. CMYK Inputs
      const cmyk = rgbToCmyk(r, g, b);
      cmykInputs.c.value = cmyk.c;
      cmykInputs.m.value = cmyk.m;
      cmykInputs.y.value = cmyk.y;
      cmykInputs.k.value = cmyk.k;
    }

    // --- Math Functions ---

    function componentToHex(c) {
      const hex = c.toString(16);
      return hex.length == 1 ? "0" + hex : hex;
    }

    function rgbToHex(r, g, b) {
      return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
    }

    function hexToRgb(hex) {
      hex = hex.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i, (m, r, g, b) => r + r + g + g + b + b);
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
      } : { r: 0, g: 0, b: 0 };
    }

    function rgbToHsl(r, g, b) {
      r /= 255, g /= 255, b /= 255;
      const max = Math.max(r, g, b), min = Math.min(r, g, b);
      let h, s, l = (max + min) / 2;

      if (max == min) {
        h = s = 0; // achromatic
      } else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
          case r: h = (g - b) / d + (g < b ? 6 : 0); break;
          case g: h = (b - r) / d + 2; break;
          case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
      }
      return { h: h * 360, s: s * 100, l: l * 100 };
    }

    function hslToRgb(h, s, l) {
      h /= 360; s /= 100; l /= 100;
      let r, g, b;
      if (s === 0) {
        r = g = b = l;
      } else {
        const hue2rgb = (p, q, t) => {
          if (t < 0) t += 1;
          if (t > 1) t -= 1;
          if (t < 1/6) return p + (q - p) * 6 * t;
          if (t < 1/2) return q;
          if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
          return p;
        };
        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        const p = 2 * l - q;
        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);
      }
      return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255) };
    }

    function rgbToCmyk(r, g, b) {
      let c = 1 - (r / 255);
      let m = 1 - (g / 255);
      let y = 1 - (b / 255);
      let k = Math.min(c, Math.min(m, y));

      c = (c - k) / (1 - k) || 0;
      m = (m - k) / (1 - k) || 0;
      y = (y - k) / (1 - k) || 0;

      return {
        c: Math.round(c * 100),
        m: Math.round(m * 100),
        y: Math.round(y * 100),
        k: Math.round(k * 100)
      };
    }

    // --- Utility Functions ---

    function generateRandomColor() {
      const r = Math.floor(Math.random() * 256);
      const g = Math.floor(Math.random() * 256);
      const b = Math.floor(Math.random() * 256);
      updateUIFromRGB(r, g, b);
      addToHistory(rgbToHex(r, g, b));
    }

    function addToHistory(hex) {
      // Avoid duplicates at the start
      if (historyStack.length > 0 && historyStack[0] === hex) return;

      historyStack.unshift(hex);
      if (historyStack.length > 7) historyStack.pop(); // Keep last 7

      renderHistory();
    }

    function renderHistory() {
      historyList.innerHTML = '';
      historyStack.forEach(color => {
        const swatch = document.createElement('div');
        swatch.className = 'history-swatch';
        swatch.style.backgroundColor = color;
        swatch.title = color;
        swatch.onclick = () => {
          const rgb = hexToRgb(color);
          updateUIFromRGB(rgb.r, rgb.g, rgb.b);
        };
        historyList.appendChild(swatch);
      });
    }

    // --- Clipboard ---

    function showToast() {
      const x = document.getElementById("toast");
      x.className = "show";
      setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }

    function triggerCopy(text) {
      const textArea = document.getElementById("hiddenCopy");
      textArea.value = text;
      textArea.select();
      document.execCommand('copy');
      showToast();
    }

    function copyToClipboard(elementId) {
      const copyText = document.getElementById(elementId);
      triggerCopy(copyText.value);
    }

    function copyToClipboardRGB() {
      const text = `rgb(${rgbInputs.r.value}, ${rgbInputs.g.value}, ${rgbInputs.b.value})`;
      triggerCopy(text);
    }

    function copyToClipboardHSL() {
      const text = `hsl(${hslInputs.h.value}, ${hslInputs.s.value}%, ${hslInputs.l.value}%)`;
      triggerCopy(text);
    }

    function copyToClipboardCMYK() {
       const text = `cmyk(${cmykInputs.c.value}%, ${cmykInputs.m.value}%, ${cmykInputs.y.value}%, ${cmykInputs.k.value}%)`;
       triggerCopy(text);
    }

  </script>

</body>
</html>

